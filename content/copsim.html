<!DOCTYPE html><html>
        <head>
        <title>5jgx</title>
        <meta charset="utf-8">
<meta property="head" content="H2">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700,900" rel="stylesheet">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/icomoon/style.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/magnific-popup.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/jquery-ui.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.carousel.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.theme.default.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap-datepicker.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/flaticon/font/flaticon.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/aos.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/style.css">
        <link rel="shortcut icon" href="./../cmsimde/static/favicons.png">
        
        <style type='text/css'>
            .site-section {
            background-color: #FFFF;
            padding: 40px 40px;
            }
            body > div > div.dropdown.open {
                display: block;
            }
        </style>
    
        <!-- <script src="./../cmsimde/static/jquery.js"></script> -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
        <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/normalize.min.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch_set.js"></script>
        <script src="tipuesearch_content.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/tipuesearch.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch.js"></script>
        <!-- for Wink3 客製化關閉 -->
        <!--
        <link rel="stylesheet" type="text/css" href="./../cmsimde/static/winkPlayer.css" />
        <script type="text/javascript" src="./../cmsimde/static/winkPlayer.js"></script>
        -->
        <script>
            /* original tipuesearch
            $(document).ready(function() {
                 $('#tipue_search_input').tipuesearch();
            });
            */
            // customed doSearch
            function doSearch() {
                $('#tipue_search_input').tipuesearch({
                    newWindow: true, 
                    minimumLength: 2,
                    wholeWords: false, // for search 中文
                });
            }
            $(document).ready(doSearch);
        </script>
        
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushBash.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDiff.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushHaxe.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPowerShell.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCSharp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDart.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushRust.js"></script>
<link type="text/css" rel="stylesheet" href="./../cmsimde/static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>
<!-- 暫時不用
<script src="./../cmsimde/static/fengari-web.js"></script>
<script type="text/javascript" src="./../cmsimde/static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->
<style>
img.add_border {
    border: 3px solid blue;
}
</style>

</head>
<body>
<div class='container'><nav>
        
    <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>
    
            <header class="site-navbar py-4 bg-white" role="banner">
              <div class="container">
                <div class="row align-items-center">
                <h1>5j-5jgx 2023 網際內容管理 - 五專精密機械工程科</h1>
                <div class="pl-4">
                    <form>
                    <input type="text" placeholder="Search" name="q" id="tipue_search_input" pattern=".{2,}" title="At least 2 characters" required>
                    </form>
                </div>
                  <!-- <div class="col-11 col-xl-2">
                    <h1 class="mb-0 site-logo"><a href="index.html" class="text-black h2 mb-0">5j-5jgx 2023 網際內容管理 - 五專精密機械工程科</a></h1> 
                  </div>
                  -->
                  <div class="col-12 col-md-10 d-none d-xl-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">
    <ul class='site-menu js-clone-nav mr-auto d-none d-lg-block'>
                        <li class="active has-children"><a href="index.html">Home</a>
                        <ul class="dropdown">
                            <li><a href="sitemap.html">Site Map</a></li>
                            <li><a href="./../reveal/index.html">reveal</a></li>
                            <li><a href="./../blog/index.html">blog</a></li>
                        </ul>
                      </li>
                     <li class='has-children'><a href='About.html'>About</a><ul class='dropdown'><li class='has-children'><a href='精密機械.html'>精密機械</a><ul class='dropdown'><li><a href='程式開發.html'>程式開發</a></li></ul><li><a href='Javascript.html'>Javascript</a><li><a href='TOEIC.html'>TOEIC</a><li><a href='nginx.html'>nginx</a><li><a href='Downloads.html'>Downloads</a><li><a href='OBS.html'>OBS</a></li></ul><li class='has-children'><a href='Arduino.html'>Arduino</a><ul class='dropdown'><li><a href='Printer.html'>Printer</a></li></ul><li class='has-children'><a href='cmsimde.html'>cmsimde</a><ul class='dropdown'><li><a href='Upload.html'>Upload</a><li><a href='ax5.html'>ax5</a><li><a href='Games.html'>Games</a></li></ul><li class='has-children'><a href='Note.html'>Note</a><ul class='dropdown'><li><a href='Windows.html'>Windows</a><li><a href='w13.html'>w13</a><li><a href='w11.html'>w11</a><li><a href='wss.html'>wss</a><li><a href='Visualization.html'>Visualization</a><li><a href='WebSocket2.html'>WebSocket2</a><li><a href='Leo Editor.html'>Leo Editor</a><li><a href='Git.html'>Git</a></li></ul><li><a href='zmqRemoteApi.html'>zmqRemoteApi</a><li class='has-children'><a href='Coppeliasim.html'>Coppeliasim</a><ul class='dropdown'><li class='has-children'><a href='WebSocket.html'>WebSocket</a><ul class='dropdown'><li><a href='瀏覽器串流.html'>瀏覽器串流</a></li></ul><li><a href='counter.html'>counter</a><li class='has-children'><a href='copsim.html'>copsim</a><ul class='dropdown'><li><a href='Sensing.html'>Sensing</a></li></ul><li><a href='Brython_ws.html'>Brython_ws</a></li></ul><li class='has-children'><a href='Brython.html'>Brython</a><ul class='dropdown'><li><a href='Brython_ex2.html'>Brython_ex2</a></li>
                      </ul>
                </nav>
              </div>
              <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>
              </div>

            </div>
          </div>
          
        </header>
    <div id="tipue_search_content">counter << <a href='counter.html'>Previous</a> <a href='Sensing.html'>Next</a> >> Sensing<br /><h1>copsim</h1>
<p>Flutter app and Coppeliasim:</p>
<p style="padding-left: 30px;">Establish communication from the Flutter app: In your Flutter app, you'll need to establish a connection to the ZMQRemoteAPI server using the appropriate ZeroMQ library for Flutter. One popular library is zeromq.dart, which provides ZeroMQ bindings for Dart.</p>
<pre class="brush:dart;auto-links:false;toolbar:false" contenteditable="false">import 'package:zeromq/zeromq.dart';

void main() async {
  // Connect to the ZMQRemoteAPI server
  final context = ZContext();
  final requester = ZSocket(context, ZSocketType.req);
  await requester.connect('tcp://localhost:23000'); // Adjust the address and port as per your setup

  // Send a command to CoppeliaSim
  final command = 'simxStartSimulation'; // Example command to start the simulation
  final commandBytes = command.codeUnits;
  await requester.send(ZFrame.fromBytes(commandBytes));

  // Receive the response from CoppeliaSim
  final response = await requester.receive();
  final responseBytes = response.first.bytes;
  final responseString = String.fromCharCodes(responseBytes);
  print('Response: $responseString');

  // Cleanup
  await requester.close();
  context.destroy();
}
</pre>
<p>Brython use Javascript ZMQ:</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">from browser import document, window

# Use the JS API to access the ZWS library
# https://github.com/zeromq/zwssock
zws = window.ZWS

# Create a ZWS socket and connect to the ZMQRemoteAPI server in CoppeliaSim
socket = zws.createSocket('ws://localhost:23000')  # Adjust the address and port as per your setup
socket.onopen = lambda event: on_socket_open(event)

# Handle socket opening
def on_socket_open(event):
    print("WebSocket connection established")
    
    # Send the ZMQRemoteAPI commands to control the BubbleRob robot
    socket.send("simxStartSimulation")
    socket.send("simxSynchronous(True)")
    socket.send("handle = simxGetObjectHandle('BubbleRob', -1)[1]")
    socket.send("simxSetJointTargetVelocity(handle, 0.5, simx_opmode_oneshot_wait)")
    
    # Move the robot in a circular path
    for _ in range(500):  # Adjust the number of iterations as needed
        socket.send("simxSynchronousTrigger()")
    
    # Stop the simulation
    socket.send("simxStopSimulation")

# Handle socket messages
def on_socket_message(event):
    print("Received message:", event.data)

# Set the message and close handlers
socket.onmessage = on_socket_message
socket.onclose = lambda event: print("WebSocket connection closed")

# Cleanup
def cleanup():
    socket.close()

# Call the cleanup function when the Brython script is terminated
document.bind("beforeunload", cleanup)
</pre>
<p>Lead BubbleRob move in circle:</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">from browser import document, window

# Use the JS API to access the ZWS library
zws = window.ZWS

# Create a ZWS socket and connect to the ZMQRemoteAPI server in CoppeliaSim
socket = zws.createSocket('ws://localhost:23000')  # Adjust the address and port as per your setup
socket.onopen = lambda event: on_socket_open(event)

# Handle socket opening
def on_socket_open(event):
    print("WebSocket connection established")

    # Send the ZMQRemoteAPI commands to control the BubbleRob robot
    socket.send("simxStartSimulation")
    socket.send("simxSynchronous(True)")
    socket.send("handle = simxGetObjectHandle('BubbleRob', -1)[1]")
    
    # Define the circle radius and target velocity
    radius = 0.5  # Adjust the circle radius as needed
    velocity = 0.5  # Adjust the target velocity as needed

    # Calculate the linear velocity and angular velocity for the circular path
    linear_velocity = velocity
    angular_velocity = linear_velocity / radius
    
    # Calculate the time required to complete the circular path
    circumference = 2 * 3.14159 * radius
    time = circumference / linear_velocity

    # Set the robot's target velocities for linear and angular motion
    socket.send(f"simxSetJointTargetVelocity(handle, {linear_velocity}, simx_opmode_oneshot_wait)")
    socket.send(f"simxSetJointTargetVelocity(handle + 1, {angular_velocity}, simx_opmode_oneshot_wait)")

    # Move the robot in a circular path for the specified time
    socket.send(f"simxPauseCommunication(True)")
    socket.send(f"simxSynchronousTrigger()")
    socket.send(f"simxPauseCommunication(False)")

    for _ in range(int(time * 1000)):  # Adjust the time scale as needed
        socket.send("simxSynchronousTrigger()")

    # Stop the robot's motion
    socket.send(f"simxSetJointTargetVelocity(handle, 0, simx_opmode_oneshot_wait)")
    socket.send(f"simxSetJointTargetVelocity(handle + 1, 0, simx_opmode_oneshot_wait)")

    # Stop the simulation
    socket.send("simxStopSimulation")

# Handle socket messages
def on_socket_message(event):
    print("Received message:", event.data)

# Set the message and close handlers
socket.onmessage = on_socket_message
socket.onclose = lambda event: print("WebSocket connection closed")

# Cleanup
def cleanup():
    socket.close()

# Call the cleanup function when the Brython script is terminated
document.bind("beforeunload", cleanup)
</pre>
<p>If you need to implement some form of access control or authentication between the Brython client and the server-side component (such as the ZMQRemoteAPI server or any other backend service), you can consider using standard web authentication mechanisms.</p>
<p>Here's a high-level overview of how you can approach implementing access control:</p>
<p>Implement a server-side authentication mechanism: On the server side, you can create an authentication system that handles user registration, login, and session management. This can be implemented using a web framework or custom server-side code.</p>
<p>Secure the server-side component: Ensure that the server-side component (e.g., ZMQRemoteAPI server or backend service) is only accessible to authenticated and authorized users. You can achieve this by validating user credentials or using access tokens for authentication.</p>
<p>Implement authentication in the Brython client: In the Brython client, you can implement authentication features such as a login form. When the user submits their credentials, the client can send a request to the server-side authentication endpoint to authenticate the user.</p>
<p>Manage user sessions: Once the user is authenticated, you can generate a session token or cookie on the server side and send it back to the Brython client. The client can store this token and include it in subsequent requests to the server to maintain the session.</p>
<p>Include the authentication token in ZMQRemoteAPI requests: When making requests to the ZMQRemoteAPI server or backend service, include the authentication token in the request headers or body. The server can validate the token to ensure that the request is coming from an authenticated user.</p>
<p>It's important to implement secure authentication practices, such as using strong passwords, secure token handling, encryption (HTTPS), and protecting against common security vulnerabilities like cross-site scripting (XSS) and cross-site request forgery (CSRF).</p>
<p>Please note that the specific implementation details will depend on your server-side technology stack and the authentication mechanisms you choose to use. You may also need to refer to the documentation of the frameworks or libraries you are using for more specific guidance.</p>
<p>Remember to follow best practices for secure authentication and consult with security experts if needed to ensure that your implementation meets your specific security requirements.</p>
<hr/>
<p><a href="./../downloads/zmqRemoteApi_for_IPv6.7z">zmqRemoteApi_for_IPv6.7z</a></p>
<p>準備在 151 建立 copsim.cycu.org 10ff:151::1</p>
<p><a href="https://forum.coppeliarobotics.com/viewtopic.php?t=9294">https://forum.coppeliarobotics.com/viewtopic.php?t=9294</a> </p>
<p><a href="https://coppeliarobotics.com/helpFiles/en/dataVisualizationAndOutput.htm">https://coppeliarobotics.com/helpFiles/en/dataVisualizationAndOutput.htm</a> </p>
<p>能否在 headless 啟動 Visualization Stream function and open scene throught programming?</p>
<p>Reference:</p>
<p style="padding-left: 30px;">You can start CoppeliaSim passing the command line parameter -GzmqRemoteApi.rpcPort=23005.</p>
<p style="padding-left: 30px;">Or with CoppeliaSim already started, execute sim.setNamedInt32Param('zmqRemoteApi.rpcPort',23005) (e.g. in the lua commander at bottom of screen) and then restart the ZMQ Remote API server addon.</p>
<p>若將 simAddonVisualization stream.lua 中的 autoStart 設為 true, 則 Coppeliasim 啟動後將自動執行 Visualization stream server.</p>
<p>且若以 coppeliasim -h -s c:\tmp\mtb_robot.ttt 指定採 headless 方式啟動 (-h), 且自動執行 simulation (-s), 則可將此一指令設為 service 讓場景的執行隨操作系統啟動.</p>
<p>simAddOZMQ remoteAPI server.lua 中修改:</p>
<pre class="brush:lua;auto-links:false;toolbar:false" contenteditable="false">function zmqRemoteApi.verbose()
    -- return tonumber(sim.getStringNamedParam('zmqRemoteApi.verbose') or '0')
    -- set zmqRemoteApi server autoStart = true
    return tonumber(sim.getStringNamedParam('zmqRemoteApi.verbose') or '1')
end</pre>
<p>可讓 zmqRemoteAPI 隨系統啟動.<br/><br/></p>
<br />counter << <a href='counter.html'>Previous</a> <a href='Sensing.html'>Next</a> >> Sensing</div>
        
    <!-- footer -->
      <div class="container">
        <div class="row pt-3 mx-auto">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
        </div>
      </div>
    <!-- for footer -->
    
        </div> <!-- for site wrap -->
            <!-- <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script> -->
            <script src="../cmsimde/static/chimper/js/jquery-migrate-3.0.1.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery-ui.js"></script>
            <script src="../cmsimde/static/chimper/js/popper.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap.min.js"></script>
            <script src="../cmsimde/static/chimper/js/owl.carousel.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.stellar.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.countdown.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.magnific-popup.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap-datepicker.min.js"></script>
            <script src="../cmsimde/static/chimper/js/aos.js"></script>
            <!--
            <script src="../cmsimde/static/chimper/js/typed.js"></script>
                    <script>
                    var typed = new Typed('.typed-words', {
                    strings: ["Web Apps"," WordPress"," Mobile Apps"],
                    typeSpeed: 80,
                    backSpeed: 80,
                    backDelay: 4000,
                    startDelay: 1000,
                    loop: true,
                    showCursor: true
                    });
                    </script>
            -->
            <script src="../cmsimde/static/chimper/js/main.js"></script>
        
<!-- 啟用 LaTeX equations 編輯 -->
  <!-- <script>
  MathJax = {
    tex: {inlineMath: [['$', '$'], ['\(', '\)']]}
  };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>-->
    </body></html>
        